export const metadata = {
  title: 'Deformation Theory — Algebraic Stacks — Math Notes',
}

import { Breadcrumbs } from '@/components/layout/Breadcrumbs'
import { Tag } from '@/components/ui/Tag'
import { StatusBadge } from '@/components/ui/StatusBadge'

<Breadcrumbs items={[
  { label: "대수 스택", href: "/algebraic-stacks" },
  { label: "5. 모듈라이 이론", href: "/algebraic-stacks/ch05-moduli-theory" },
  { label: "Concept — Deformation Theory" },
]} />

<div className="mb-6">
  <div className="flex items-center gap-3 mb-3">
    <Tag type="concept" />
    <StatusBadge status="complete" />
  </div>
</div>

# Deformation Theory

Deformation theory is the study of how geometric objects vary in infinitesimal families. It provides the local description of moduli spaces: the tangent space, obstruction space, and formal neighborhood of a point in a moduli space are all described by deformation-theoretic data.

---

## 1. Infinitesimal Deformations

<Definition title="First-Order Deformation">
Let $X_0$ be a scheme (or object) over a field $k$. A **first-order deformation** of $X_0$ is a flat morphism $\mathcal{X} \to \mathrm{Spec}\, k[\varepsilon]/(\varepsilon^2)$ together with an isomorphism $\mathcal{X} \otimes_{k[\varepsilon]} k \cong X_0$.

The set of first-order deformations (up to isomorphism) is denoted $\mathrm{Def}_{X_0}(k[\varepsilon]/(\varepsilon^2))$ and forms the **tangent space** to the deformation functor.
</Definition>

<Definition title="Deformation Functor">
The **deformation functor** of $X_0$ is the functor
$$\mathrm{Def}_{X_0} : \mathsf{Art}_k \to \mathsf{Sets}$$
from the category of local Artinian $k$-algebras $(A, \mathfrak{m}_A)$ with residue field $k$ to sets, defined by
$$A \mapsto \left\lbrace \text{flat deformations } \mathcal{X} \to \mathrm{Spec}\, A \text{ with } \mathcal{X} \otimes_A k \cong X_0 \right\rbrace / \cong$$
</Definition>

<Example title="Deformations of a Smooth Variety">
Let $X$ be a smooth projective variety over $k$. First-order deformations of $X$ are classified by
$$\mathrm{Def}_X(k[\varepsilon]/(\varepsilon^2)) \cong H^1(X, T_X)$$
where $T_X = \mathcal{H}om(\Omega^1_X, \mathcal{O}_X)$ is the tangent sheaf. This comes from the exact sequence
$$0 \to \mathcal{O}_X \xrightarrow{\varepsilon} \mathcal{O}_{\mathcal{X}} \to \mathcal{O}_X \to 0$$
and the identification of extensions of $X$ by $\mathcal{O}_X$ with elements of $H^1(X, T_X)$.
</Example>

<Example title="Deformations of a Smooth Curve">
For a smooth curve $C$ of genus $g$:
$$\mathrm{Def}_C(k[\varepsilon]/(\varepsilon^2)) \cong H^1(C, T_C)$$
By Serre duality, $H^1(C, T_C) \cong H^0(C, \omega_C^{\otimes 2})^{\vee}$, which has dimension $3g - 3$ for $g \geq 2$. This is the tangent space to $\mathcal{M}_g$ at $[C]$.
</Example>

<Example title="Deformations of a Node">
Consider the nodal singularity $\mathrm{Spec}\, k[x,y]/(xy)$. Its first-order deformations are given by the family $xy = t\varepsilon$ over $k[\varepsilon]/(\varepsilon^2)$. The deformation space is 1-dimensional, reflecting the smoothing parameter $t$.

More precisely, $T^1 = \mathrm{Ext}^1(\Omega^1_{k[x,y]/(xy)}, k) \cong k$, generated by the smoothing $xy = t$.
</Example>

---

## 2. Higher-Order Deformations and Obstructions

<Definition title="Obstruction">
Given a deformation $\mathcal{X}_A$ over $\mathrm{Spec}\, A$ and a small extension
$$0 \to I \to A' \to A \to 0$$
(where $I$ is an ideal with $\mathfrak{m}_{A'} \cdot I = 0$, so $I$ is a $k$-vector space), the **obstruction** to lifting $\mathcal{X}_A$ to a deformation over $\mathrm{Spec}\, A'$ is an element
$$\mathrm{ob}(\mathcal{X}_A, A' \to A) \in \mathrm{Ob}(X_0) \otimes_k I$$
where $\mathrm{Ob}(X_0)$ is the **obstruction space**. The lift exists if and only if this element vanishes.
</Definition>

<Example title="Obstruction Space for Smooth Varieties">
For a smooth projective variety $X$, the obstruction space is
$$\mathrm{Ob}(X) = H^2(X, T_X)$$
If $H^2(X, T_X) = 0$, then $X$ is **unobstructed**: every deformation extends to all orders, and the formal moduli space is smooth.
</Example>

<Example title="Curves are Unobstructed">
For a smooth curve $C$ of genus $g \geq 2$:
$$H^2(C, T_C) = 0$$
since $\dim C = 1$. Therefore curves are always unobstructed, and $\mathcal{M}_g$ is smooth. This is why $\mathcal{M}_g$ is a smooth DM stack of dimension $3g - 3$.
</Example>

<Example title="Abelian Varieties are Unobstructed">
For an abelian variety $A$ of dimension $g$:
$$T_A \cong \mathcal{O}_A^g, \quad H^1(A, T_A) \cong H^1(A, \mathcal{O}_A)^g \cong k^{g^2}$$
$$H^2(A, T_A) \cong H^2(A, \mathcal{O}_A)^g \cong k^{g \binom{g}{2}}$$
So the obstruction space is nonzero for $g \geq 2$! However, by a theorem of Grothendieck-Mumford, abelian varieties are still unobstructed (the obstructions vanish). The moduli space $\mathcal{A}_g$ of principally polarized abelian varieties has dimension $\binom{g+1}{2}$, matching $\dim H^1(A, T_A)$ when restricted to polarization-preserving deformations.
</Example>

<Example title="K3 Surfaces">
For a K3 surface $S$:
$$H^1(S, T_S) \cong H^1(S, \Omega^1_S) \cong k^{20}$$
$$H^2(S, T_S) \cong H^2(S, \Omega^1_S) \cong k^0 = 0$$
(using the triviality of $\omega_S$ and the Hodge diamond). So K3 surfaces are unobstructed with 20-dimensional moduli.
</Example>

<Example title="Obstructed Example: Rigid Calabi-Yau">
Consider a general Calabi-Yau threefold $X$ with $h^{2,1}(X) = 0$ (a "rigid" Calabi-Yau). Then:
$$H^1(X, T_X) = 0, \quad H^2(X, T_X) \neq 0$$
The deformation space is a point (no nontrivial deformations), but the obstruction space is nonzero. The obstructions are "vacuous" since there are no deformations to obstruct.
</Example>

---

## 3. The Tangent-Obstruction Complex

<Definition title="Cotangent Complex">
For a morphism $f: X \to Y$ of schemes, the **cotangent complex** $\mathbb{L}_{X/Y}$ is an object in the derived category $D^{\leq 0}(\mathsf{QCoh}(X))$. For a smooth morphism, $\mathbb{L}_{X/Y} \simeq \Omega^1_{X/Y}[0]$. In general, if $X = \mathrm{Spec}\, B$ and $Y = \mathrm{Spec}\, A$ with a presentation $B = P/I$ where $P = A[x_1, \ldots, x_n]$ is a polynomial algebra, then
$$\mathbb{L}_{B/A} \simeq [I/I^2 \to \Omega^1_{P/A} \otimes_P B]$$
concentrated in degrees $[-1, 0]$.
</Definition>

<Theorem title="Deformation Theory via Cotangent Complex">
For a scheme $X_0$ over $k$ and a small extension $0 \to I \to A' \to A \to 0$:
1. The set of liftings of a deformation $\mathcal{X}_A$ to $A'$, if nonempty, is a torsor under $\mathrm{Ext}^0(L_{X_0/k}, I \otimes_k \mathcal{O}_{X_0}) = \mathrm{Hom}(\Omega^1_{X_0}, \mathcal{O}_{X_0}) \otimes I$.
2. The obstruction to the existence of a lifting lies in $\mathrm{Ext}^1(\mathbb{L}_{X_0/k}, I \otimes_k \mathcal{O}_{X_0})$.
3. Automorphisms of a lifting are given by $\mathrm{Ext}^{-1}(\mathbb{L}_{X_0/k}, I \otimes_k \mathcal{O}_{X_0})$.
</Theorem>

<Example title="Cotangent Complex of a Complete Intersection">
Let $X = V(f_1, \ldots, f_r) \subset \mathbb{A}^n$ be a complete intersection. Then
$$\mathbb{L}_{X/k} \simeq [\mathcal{O}_X^r \xrightarrow{(df_1, \ldots, df_r)} \Omega^1_{\mathbb{A}^n}|_X]$$
The tangent space to deformations is $\mathrm{Ext}^1(\mathbb{L}_{X/k}, \mathcal{O}_X)$ and obstructions lie in $\mathrm{Ext}^2(\mathbb{L}_{X/k}, \mathcal{O}_X)$.
</Example>

---

## 4. Deformations of Sheaves

<Definition title="Deformations of a Coherent Sheaf">
Let $\mathcal{F}_0$ be a coherent sheaf on a fixed scheme $X$ over $k$. A **deformation** of $\mathcal{F}_0$ over $A \in \mathsf{Art}_k$ is a coherent sheaf $\mathcal{F}$ on $X_A = X \times \mathrm{Spec}\, A$, flat over $A$, with $\mathcal{F} \otimes_A k \cong \mathcal{F}_0$.
</Definition>

<Theorem title="Deformation Theory of Sheaves">
For a coherent sheaf $\mathcal{F}_0$ on a smooth projective variety $X$:
- **Tangent space**: $\mathrm{Def}_{\mathcal{F}_0}(k[\varepsilon]) \cong \mathrm{Ext}^1(\mathcal{F}_0, \mathcal{F}_0)$.
- **Obstruction space**: Obstructions lie in $\mathrm{Ext}^2(\mathcal{F}_0, \mathcal{F}_0)$.
- **Automorphisms**: $\mathrm{Aut}_{\mathrm{inf}}(\mathcal{F}_0) \cong \mathrm{Ext}^0(\mathcal{F}_0, \mathcal{F}_0) = \mathrm{End}(\mathcal{F}_0)$.
</Theorem>

<Example title="Deformations of a Line Bundle">
For a line bundle $\mathcal{L}$ on a smooth variety $X$:
$$\mathrm{Ext}^1(\mathcal{L}, \mathcal{L}) \cong H^1(X, \mathcal{O}_X)$$
$$\mathrm{Ext}^2(\mathcal{L}, \mathcal{L}) \cong H^2(X, \mathcal{O}_X)$$
So the deformation space of a line bundle is the same as the tangent space to $\mathrm{Pic}(X)$, which is $H^1(X, \mathcal{O}_X)$, consistent with $\dim \mathrm{Pic}^0(X) = h^{0,1}$.
</Example>

<Example title="Deformations of the Structure Sheaf of a Point">
Let $\mathcal{F}_0 = k(p) = \mathcal{O}_X / \mathfrak{m}_p$ for a smooth point $p \in X$ with $\dim X = n$. Then:
$$\mathrm{Ext}^i(k(p), k(p)) \cong \binom{n}{i} \cdot k$$
So the tangent space to deformations has dimension $n$ and the obstruction space has dimension $\binom{n}{2}$. For a surface ($n = 2$), the obstruction space is 1-dimensional but obstructions vanish (Fogarty's theorem), and for $n \geq 3$, genuine obstructions can appear.
</Example>

---

## 5. Formal Moduli and Pro-Representability

<Definition title="Pro-Representable Functor">
A deformation functor $F: \mathsf{Art}_k \to \mathsf{Sets}$ is **pro-representable** if there exists a complete local $k$-algebra $R = \varprojlim R/\mathfrak{m}_R^n$ such that
$$F(A) \cong \mathrm{Hom}_{\text{cont}}(R, A)$$
for all $A \in \mathsf{Art}_k$. The ring $R$ is the **versal deformation ring** (or hull).
</Definition>

<Example title="Formal Moduli of a Smooth Curve">
For a smooth curve $C$ of genus $g \geq 2$, the formal moduli is pro-represented by $R = k[[t_1, \ldots, t_{3g-3}]]$ (a power series ring, since $C$ is unobstructed). The formal universal deformation $\mathcal{C} \to \mathrm{Spf}\, R$ induces all formal deformations of $C$.
</Example>

<Example title="Formal Moduli of a Node">
The formal moduli of the node $\mathrm{Spec}\, k[[x,y]]/(xy)$ is pro-represented by $R = k[[t]]$. The universal deformation is $\mathrm{Spec}\, k[[x,y,t]]/(xy - t)$, which smooths the node when $t \neq 0$.
</Example>

<Example title="Formal Moduli with Obstructions">
Consider a smooth projective surface $S$ with $H^2(S, T_S) \neq 0$. The formal moduli is pro-represented by $R = k[[t_1, \ldots, t_m]] / (f_1, \ldots, f_r)$ where $m = h^1(S, T_S)$ and the relations $f_i$ come from obstructions. The moduli space can be singular.

For instance, the Barth-Nieto quintic in $\mathbb{P}^4$ has $H^2(T) \neq 0$ and the deformation space has a non-reduced component.
</Example>

---

## 6. The $T^i$ Functors

<Definition title="$T^i$ Functors of Lichtenbaum-Schlessinger">
For a $k$-algebra $B = P/I$ with $P$ smooth, the **$T^i$ functors** are:
$$T^0_{B/k} = \mathrm{Der}_k(B, B) \quad \text{(derivations, i.e., infinitesimal automorphisms)}$$
$$T^1_{B/k} = \mathrm{coker}(\mathrm{Der}_k(P, B) \to \mathrm{Hom}_B(I/I^2, B)) \quad \text{(first-order deformations)}$$
$$T^2_{B/k} \quad \text{(obstructions)}$$
For a global variety $X$, $T^1_X = \mathrm{Ext}^1(\Omega^1_X, \mathcal{O}_X)$ and $T^2_X = \mathrm{Ext}^2(\Omega^1_X, \mathcal{O}_X)$.
</Definition>

<Example title="$T^1$ of the Whitney Umbrella">
Consider $B = k[x,y,z]/(x^2 - y^2 z)$. This is the Whitney umbrella, which has a non-isolated singularity along the $z$-axis. The local $T^1$ is supported along the singular locus, and computing it involves:
$$T^1 = \mathrm{Hom}(I/I^2, B) / \mathrm{Der}(P, B)|_I$$
where $I = (x^2 - y^2 z)$. A generator of $I/I^2$ maps to $B$, and the cokernel by derivation images gives the deformation space.
</Example>

---

## 7. Deformation Theory for Stacks

<Remark title="Deformation Theory in the Stacky Setting">
For an algebraic stack $\mathcal{X}$, the deformation theory is governed by the cotangent complex $\mathbb{L}_{\mathcal{X}}$ in the derived category. For a point $x: \mathrm{Spec}\, k \to \mathcal{X}$ with automorphism group $G_x$:

- **$\mathrm{Ext}^{-1}(\mathbb{L}_{\mathcal{X}}|_x, k)$**: Lie algebra of $G_x$ (infinitesimal automorphisms).
- **$\mathrm{Ext}^0(\mathbb{L}_{\mathcal{X}}|_x, k)$**: First-order deformations (tangent space to $\mathcal{X}$).
- **$\mathrm{Ext}^1(\mathbb{L}_{\mathcal{X}}|_x, k)$**: Obstruction space.

This "three-term" deformation theory is characteristic of (1-)stacks. For derived stacks, the cotangent complex can have cohomology in arbitrary non-positive degrees.
</Remark>

<Example title="Deformation Theory of $\mathcal{M}_g$ at $[C]$">
At a point $[C] \in \mathcal{M}_g$ corresponding to a curve with automorphism group $G = \mathrm{Aut}(C)$:
- $\mathrm{Ext}^{-1} = \mathrm{Lie}(G) = H^0(C, T_C) = 0$ for $g \geq 2$ (no global vector fields).
- $\mathrm{Ext}^0 = H^1(C, T_C) \cong k^{3g-3}$ (first-order deformations).
- $\mathrm{Ext}^1 = H^2(C, T_C) = 0$ (unobstructed).

The formal neighborhood of $[C]$ in $\mathcal{M}_g$ is $[\mathrm{Spf}\, k[[t_1, \ldots, t_{3g-3}]] / G]$.
</Example>
